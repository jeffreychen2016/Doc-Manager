ce.erp.export.invoice.query = SELECT DISTINCT \
	vou_ven_code AS vendornumber \
     , vou_inv_code AS invoicenumber \
     , vou_inv_date AS invoicedate \
     , vou_inv_amt AS invoiceamount \
  	FROM da.voucher \
 	WHERE vou_rev_date IS NULL \
	   AND NVL(vou_eft_flag,'N') = 'N' \ 
	   AND vou_inv_amt > 0 \
           AND TRUNC (NVL (vou__iu__update_date, vou__iu__create_date)) > date ${erp.export.invoice.modifiedOn}

ce.erp.export.vendor.query = SELECT DISTINCT \
	bp_code AS vendornumber \
     , CASE \
        WHEN 1 = 1 \
        THEN bp_name \
        ELSE ' - Do NOT Contact' \
       END AS vendorName \
     , bp_add1  AS address1 \
     , bp_add2  AS address2 \
     , bp_add3  AS city \
     , bp_region_code AS state \
     , bp_postal_code AS zip \
     , bp_country AS countrycode \
     , '' AS locationcode \
     , bp_aka_name AS dbaname \
     , '' AS remitemail \
     , CASE \
         WHEN LENGTH(bp_registration_code) - LENGTH(REPLACE(bp_registration_code,'-','')) = 2 \
         THEN '' \
         ELSE bp_registration_code \
       END AS taxid \
     , '' AS dunsnumber \
     , '' AS projectedannualspend \
     , sysc_contact_desc AS vendorcontacttitle \
     , sysc_prefix_name  AS vendorcontactprefix \
     , sysc_suffix_name  AS vendorcontactsuffix \
     , sysc_first_name AS vendorfirstname \
     , sysc_last_name AS vendorlastname \
     , sysc_email1  AS vendorcontactemailaddress \
     , sysc_work_phone_num AS vendorcontactphonenumber \
     , bpven_term_code AS terms \
     , (SELECT COUNT (1) \
          FROM da.voucher \
         WHERE vou_comp_code = bpven_comp_code \
           AND vou_ven_code = bpven_bp_code \
           AND vou_rev_date IS NULL) AS transactioncount \
     , CASE \
        WHEN bpven_paymode_id IS NOT NULL \
          THEN bpven_paymode_id \
        ELSE \
          CASE \
            WHEN bpven_eft_flag = 'Y' \
              THEN 'EFT' \
            ELSE 'Check' \
          END \
        END  AS currentpaymentmethod \
     , '' AS responsecode \
     , '' AS responsemessage \
  FROM da.bpartners_table \
  INNER JOIN da.bpvendors \
    ON bpven_bp_code = bp_code \
  LEFT JOIN da.term \
    ON bpven_term_code = term_code \
    AND bpven_comp_code = term_comp_code \
  LEFT JOIN da.syscontact \
    ON bpven_bp_code = sysc_partn_code \
    AND sysc_partn_type_code = 'P' \
    AND sysc_primary_flag = 'Y' \
 WHERE NVL(bpven_eft_flag,'N') = 'N'  \    
    AND NVL(bpven_active_flag,'1') = '1'  \                       
    AND  bpven_class_code <> 'EMP' \
    AND TRUNC (NVL (bpven__iu__update_date, bpven__iu__create_date)) >= date ${erp.export.vendor.modifiedOn} 

